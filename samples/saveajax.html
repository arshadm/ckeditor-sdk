<!DOCTYPE html>
<!--
Copyright (c) 2003-2014, CKSource - Frederico Knabben. All rights reserved.
For licensing, see LICENSE.md or http://ckeditor.com/license
-->
<html>
<head>
	<meta charset="utf-8">
	<meta name="sdk-category" content="Integration">
	<meta name="sdk-subcategory" content="Saving Data">
	<meta name="description" content="Getting data from CKEditor in Ajax applications. .">
	<meta name="keywords" content="ckeditor, editor, wysiwyg, readonly, read-only, noneditable, ineditable, configure, configuration, setup, settings, options, customization, customize, customise, customisation, config, modification, modify, change">
	<title>CKEditor in AJAX applications</title>
	<!--<link href="http://fonts.googleapis.com/css?family=Maven+Pro:700,500,400" rel="stylesheet">-->
	<link href="../theme/css/sdk.css" rel="stylesheet">
	<script src="../vendor/ckeditor/ckeditor.js"></script>
	<script src="assets/simplesample.js"></script>
	<!--[if lt IE 9]>
	<script src="assets/html5shiv.min.js"></script>
	<![endif]-->
	<script data-sample="one">

			var editor1, html = '';

			function createEditor() {
				if ( editor1 )
					return;

				// Create a new editor inside the <div id="editor">, setting its value to html
				var config = {};
				editor1 = CKEDITOR.appendTo( 'editor1', config, html );

				// Update buttons states
				document.getElementById( 'remove' ).style.display = '';
				document.getElementById( 'create' ).style.display = 'none';
			}

			function removeEditor() {
				if ( !editor1 )
					return;

				// Retrieve the editor contents. In an Ajax application, this data would be
				// sent to the server or used in any other way.
				html = editor1.getData();

				// Update <div> with "Edited Contents"
				document.getElementById( 'editorcontents1' ).innerHTML = html;
				// Show <div> with "Edited Contents"
				document.getElementById( 'contents1' ).style.display = '';
				// Update buttons states
				document.getElementById( 'remove' ).style.display = 'none';
				document.getElementById( 'create' ).style.display = '';

				// Destroy the editor.
				editor1.destroy();
				editor1 = null;
			}

	</script>
</head>
<body>
	<header class="sdk-header">
	</header>
	<section class="sdk-container">
		<nav class="sdk-sidebar">
		</nav>
		<section class="sdk-contents">
			<h1>CKEditor in AJAX applications <a class="documentation" href="http://docs.ckeditor.com/#!/guide/dev_readonly">Documentation</a></h1>

			<div class="description">
				<p>
					With inline editing and the possibility to create and destroy CKEditor instances dynamically, CKEditor is an ideal solution for AJAX applications. Getting updated data from
					CKEditor is easy thanks to rich JavaScript API. It is also possible to detect whenever a change is made in the editor thanks to the
					<code><a href="http://docs.ckeditor.com/#!/api/CKEDITOR.editor-event-change">change</a></code> event, which makes additional features like auto saving really easy to develop.
				</p>

			</div>
			<h2 class="editor-title">Creating and destroying CKEditor on the fly</h2>

			<p>In this sample CKEditor is created dynamically after pressing "Create Editor" button. After pressing "Remove Editor" the content from CKEditor will be passed to a <code>&lt;div&gt;</code> element and CKEditor will be removed.</p>
			<p>This functionality is achieved using just three simple methods: <code><a href="http://docs.ckeditor.com/#!/api/CKEDITOR-method-appendTo">CKEDITOR.appendTo()</a></code>, <code><a href="http://docs.ckeditor.com/#!/api/CKEDITOR.editor-method-getData">editor.getData()</a></code> and <code><a href="http://docs.ckeditor.com/#!/api/CKEDITOR.editor-method-destroy">editor.destroy()</a></code></p>
			<button data-sample-name="one" class="sdk-get-source">Get source</button>
			<p data-sample="one">
				<input onclick="createEditor();" type="button" value="Create Editor" id="create">
				<input onclick="removeEditor();" type="button" value="Remove Editor" id="remove" style="display:none">
			</p>

			<!-- This div will hold the editor. -->
			<div id="editor1" data-sample="one">
			</div>
			<div id="contents1" style="display: none" data-sample="one">
				<h3>
					Edited Contents
				</h3>
				<!-- This div will be used to display the editor contents. -->
				<div data-sample="one" id="editorcontents1">
				</div>
			</div>

			<h2 class="editor-title">Events: <code>change</code></h2>

			<p>Whenever a change is made in the editor, CKEditor fires a <code><a href="http://docs.ckeditor.com/#!/api/CKEDITOR.editor-event-change">change</a></code> event making it possible to auto-save data on the fly. In the sample below, the <code>change</code> event is used to mirror entered content below the editor. To see it in action, start typing in the editing area.</p>
			<button data-sample-name="two" class="sdk-get-source">Get source</button>
			<textarea cols="80" id="editor2" name="editor2" rows="10" data-sample="two">
			</textarea>

			<div id="contents2" style="display: none" data-sample="two">
				<p>Number of change events: <span id="changes"></span>.</p>
				<h3>
					Mirrored Contents
				</h3>
				<!-- This div will be used to display the editor contents. -->
				<div id="editorcontents2">
				</div>
			</div>

			<div class="note">
				<p>Saving data is a server side operation and you are free to implement the save functionality on your own, in any way you like. CKEditor is a pure JavaScript component and it doesn't offer anything more than JavaScript methods and events to access the data, so that you could save it on the server.</p><p>Be aware that there is a <strong><a href="http://ckeditor.com/addon/save">Save</a></strong> plugin for CKEditor, which provides a <strong>Save</strong> button, which fires a <code><a href="http://docs.ckeditor.com/#!/api/CKEDITOR.editor-event-save">save</a></code> event, but it currently works only for classic CKEditor placed inside a &lt;form&gt; element. If you would like to use the Save button to save data without reloading the page, e.g. in Ajax application using an inline editor, then check <a href="TODO">the documentation about saving data</a>.</p>
			</div>

			<div class="todo">
				<p>Write a single documentation page about saving data. Nothing fancy, just things that are written in SDK samples already (savetextarea and saveajax) and move there the bit of information we have in <a href="http://docs.ckeditor.com/#!/guide/dev_framed-section-saving-the-editor-data">saving the editor data</a> section for classic editor.</p>

				<p>Repeat there the warning about the Save plugin, explain how to enable it for inline editors or editors that are not wrapped by a &lt;form&gt; element. The plugin is generally stupid right now so we need to explain it: <a href="http://dev.ckeditor.com/ticket/12167">http://dev.ckeditor.com/ticket/12167</a></p>
			</div>
			<script data-sample="two">
				(function () {
					var changesCount = 0;
					var editor2 = CKEDITOR.replace( 'editor2', {
						removePlugins: 'sourcearea'

					} );
					editor2.on( 'save', function ( ev ) {
						changesCount = 0;
						console.log( 'save', ev );
						//document.getElementById('mirror');
					} );
					editor2.on( 'change', function ( ev ) {
						changesCount++;
						console.log( 'change', ev );
						document.getElementById( 'contents2' ).style.display = '';
						document.getElementById( 'changes' ).innerHTML = changesCount.toString();
						document.getElementById( 'editorcontents2' ).innerHTML = editor2.getData();
					} );
				})();

			</script>
		</section>
	</section>

	<footer class="sdk-footer">
	</footer>
</body>
</html>
